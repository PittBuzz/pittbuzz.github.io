## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(statsr)
library(BAS)
library(GGally)       
library(grid)          
library(gridExtra)   
library(MASS)         

```

### Load data


```{r load-data}
load("movies.Rdata")

glimpse(movies)
dim(movies)
```



* * *

## Part 1: Data
The data set is comprised of 651 randomly sampled movies produced and released before 2016. This is an observational study and therefore cannot be used for causation.  The results can be generalized.

* * *

## Part 2: Data manipulation

Create new variables based on existing fields to categorize potential influencers.
```{r mutate columns}
movies2 <- movies %>%
  mutate(feature_film = as.factor(ifelse(title_type == 'Feature Film', 'yes', 'no'))) %>%
  mutate(drama = as.factor(ifelse(genre == 'Drama', 'yes', 'no'))) %>%
  mutate(mpaa_rating_R = as.factor(ifelse(mpaa_rating == 'R', 'yes', 'no'))) %>%
  mutate(oscar_season = as.factor(ifelse(thtr_rel_month %in% c(10,11,12) , 'yes', 'no'))) %>%
  mutate(summer_season = as.factor(ifelse(thtr_rel_month %in% c(5,6,7,8) , 'yes', 'no'))) 

```

```{r review new df}
head(movies2)
glimpse(movies2)
dim(movies2)

```


* * *

## Part 3: Exploratory data analysis

The response variable is <b> audience score</b>. We will examine the variable statistics as well as its relationship to the several independent variables.  The first step is examine score frequencies and outputs followed by visual outptus of comparative analyses.
```{r}
describe(movies2$audience_score)
hist(movies2$audience_score, breaks = 20)
```
The audience_score shows a slight left skewed structure. The GMD is 23.14 The IQR of the audience_score is 34 (1st Qu - 46 and 3rd Qu. 80), while the mean is around 62.4, the median is 65 
and the mode is about 80.42

<h4><b>Analysis of the newly created features</b></h4>
We'll have a look at the newly created features <b>oscar_season, summer_season, mpaa_rating_R, drama and feature_film</b>. We create a boxplot for each feature, as well as a scatter plot for run time 
comparing them with the audience_score. We will also analyse the variability of the new features by comparing them to each other.
```{r}
# Remove the NA value from runtime since we are going to 
# use this as predictor later on.
movies2 <- filter(movies, !is.na(runtime))
```


```{r}
### Examine Relationships between the outcome variable and other variables

## top 200 box office
p1 <- ggplot(movies2, aes(x = top200_box, y =  audience_score)) + geom_boxplot() + labs(main = "Top 200 Box Office")
## summer season
p2 <- ggplot(movies2, aes(x = summer_season, y = audience_score)) + geom_boxplot() +  labs(X = "Summer Seson")
## oscar season
p3 <- ggplot(movies2, aes(x = oscar_season, y = audience_score)) + geom_boxplot() +  labs(X = "Oscar Season")
## drama
p4 <- ggplot(movies2, aes(x = drama, y = audience_score)) + geom_boxplot() + labs(X= "Drama")
## feature film
p5 <- ggplot(movies2,aes(x = feature_film, y = audience_score)) + geom_boxplot() +  labs(X="Feature Film")
## mpaa rating R
p6 <- ggplot(movies2,aes(x = mpaa_rating_R, y = audience_score)) + geom_boxplot() + labs(X = "MPAA Rating R")
## run time
p7 <- ggplot(movies2,aes(x = runtime, y = audience_score)) + geom_point() + geom_smooth() + labs(X = "Run Time")

# arrange the previously created plots 
grid.arrange(p1, p2, p3, p4, p5, p6, p7, ncol = 2)
```



