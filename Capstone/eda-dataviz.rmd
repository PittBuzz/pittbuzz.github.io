---
title: "EDA_Data Viz"
author: "J. Voltz"
date: "9/23/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load the Seoul Bike Sharing



```{r data}

seoul_bike_sharing <- "https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-RP0321EN-SkillsNetwork/labs/datasets/seoul_bike_sharing.csv"  
seoul_bike_sharing  <- read.csv(seoul_bike_sharing)


```

## Recast DATE as a date

```{r dates}
library(dplyr)

seoul_bike_sharing <- seoul_bike_sharing %>%
 mutate(DATE = as.Date(DATE, format = "%m/%d/%y"))

head(seoul_bike_sharing)
```

## Cast HOURS as categorical variable
Coerce its levels to be an ordered sequence
```{r hours}
seoul_bike_sharing <- seoul_bike_sharing %>%
 mutate(HOUR =  as.factor(HOUR),
       levels(0:24))

head(seoul_bike_sharing)

```

## Check the df structure
```{r}
glimpse(seoul_bike_sharing)
```
## Check to see if there are missing values
```{r na}
sum(is.na(seoul_bike_sharing))

```
## Dataset summary
```{r}
summary(seoul_bike_sharing)

```
## Based on the above statistics calculate how many holidays there are
```{r}
408/24
```
## Calculate the percentage of records that fall on a holiday
```{r}
408/8465
```
## group the data by SEASONS, and use the summarize() function to calculate the seasonal total rainfall and snowfall.
```{r}
seoul_bike_sharing %>%
    group_by(SEASONS) %>%
    summarize(sum(RAINFALL), sum(SNOWFALL))
```

## Load the ggplot2 package so we can generate some data visualizations.
```{r}
library(ggplot2)

# Create a scatter plot of RENTED_BIKE_COUNT vs DATE
ggplot(seoul_bike_sharing, aes(x = DATE, y = RENTED_BIKE_COUNT)) +
    geom_point(alpha = .5)

```
## Create the same plot of the RENTED_BIKE_COUNT time series, but now add HOURS as the colour.
```{r}
ggplot(seoul_bike_sharing, aes(x = DATE, y = RENTED_BIKE_COUNT, fill = HOUR)) +
    geom_point(alpha = .5)
```
## Create a histogram overlaid with a kernel density curve
```{r}
ggplot(seoul_bike_sharing, aes(x = DATE, y = ..density..)) +
    geom_histogram(color = 'black',fill = 'white',alpha = .5)
```

We can see from the histogram that most of the time there are relatively few bikes rented. Indeed, the 'mode', or most frequent amount of bikes rented, is about 250.

Judging by the 'bumps' at about 700, 900, and 1900, and 3200 bikes, it looks like there may be other modes hiding within subgroups of the data.

Interestingly, judging from the tail of the distribution, on rare occasions there are many more bikes rented out than usual.

## Correlation between two variables (scatter plot)

```{r}
ggplot(seoul_bike_sharing, aes(x = TEMPERATURE, y =RENTED_BIKE_COUNT, color = HOUR)) +
    geom_point(alpha = 1/5) +
    facet_wrap(~SEASONS)
```
Visually, we can see some strong correlations as approximately linear patterns.



Comparing this plot to the same plot below, but without grouping by SEASONS, shows how important seasonality is in explaining bike rental counts.
```{r}
ggplot(seoul_bike_sharing) +
   geom_point(aes(x=TEMPERATURE,y=RENTED_BIKE_COUNT,colour=HOUR),alpha=1/5)

```

## Create a display of four boxplots of RENTED_BIKE_COUNT vs. HOUR grouped by SEASONS.
```{r}
ggplot(seoul_bike_sharing, aes(x=HOUR,y=RENTED_BIKE_COUNT)) +
   geom_boxplot() + 
    facet_wrap(~SEASONS)
```
Although the overall scale of bike rental counts changes with the seasons, key features remain very similar. For example, peak demand times are the same across all seasons, at 8 am and 6 pm.


## Group the data by DATE, and use the summarize() function to calculate the daily total rainfall and snowfall.
```{r}
by_date <- seoul_bike_sharing %>%
    group_by(DATE) %>%
    summarize(Tot_Rain = sum(RAINFALL), Tot_Snow = sum(SNOWFALL))

by_date

ggplot(by_date, aes(Tot_Rain, Tot_Snow)) +
    geom_point()
```

## Determine how many days had snowfall.
```{r}
Snow_days <- seoul_bike_sharing %>%
    group_by(DATE)

   count_days <- summarize(Snow_days, count = n(),Tot_Snow = SNOWFALL, na.rm = TRUE)
   
   count_days <- filter(count_days, Tot_Snow > 0)
   count_days
```

